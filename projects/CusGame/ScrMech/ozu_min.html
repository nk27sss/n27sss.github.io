<!DOCTYPE html>
<html>

<head>
	<title>Создание JSON OZU</title>
	<style type="text/css"> * { background: #000; color: #0d0; font-family: "Consolas"; font-size: 16px; line-height: 1.1; -moz-tab-size: 2; -o-tab-size: 2; tab-size: 2; } #content { background-color: #000; background: repeating-linear-gradient( #39392F, #39392F 1px, #272822 1px, #272822 17px); }
</style>
</head>

<body>
	<div>
		<input type="button" value="Выполнить" onclick='start()'>
		<input type="button" value="Отладчик и просмотр" id="otliprosmotr" onclick='viewurl()'>
		<input type="button" value="Вид кода (Normal/Pre)" onclick='tagalka()'>
		<input type="button" value="Скопировать Всё" onclick='copylka()'>
		<a id="downloadfile" href="" download="blueprint.json">Файл: blueprint.json</a>
	</div>
	<hr>
	<pre id='content'></pre>
	<script type='text/javascript'>
var content=document.getElementById("content");var dbuger=(Gett().get('a')>0)?true:false;var pVAR,pREQ,pOUT,pW,pR,siW,orO,ioRe,regN,mem;var size=32;start();function viewurl(){if(dbuger){Gett().set('a',null).ass()}else{Gett().set('a',1).ass()}}function start(){enablecomments=dbuger;try{var etx=exec();if(dbuger){tagalka("pre");document.getElementById("otliprosmotr").style="color:#f00";content.innerHTML=etx.replace(/    /g,"\t");document.getElementById("downloadfile").style="display: none"}else{tagalka("normal");document.getElementById("otliprosmotr").style="";etxns=etx.replace(/\s/g,'');content.innerHTML=etxns;document.getElementById("downloadfile").href="data:text/plain;charset=utf-8,%EF%BB%BF"+encodeURIComponent(etxns)}}catch(e){content.innerHTML="<b>Ошибка</b> "+e.name+":"+e.message+"\n"}}function tagalka(st){if(st){content.style.whiteSpace=st}else{content.style.whiteSpace=(content.style.whiteSpace=="normal")?"pre":"normal"}}function copylka(){var range=document.createRange();range.selectNode(content);window.getSelection().addRange(range);try{var successful=document.execCommand('copy');var msg=successful?'successful':'unsuccessful';console.log('Copy email command was '+msg)}catch(err){console.log('Oops, unable to copy')}window.getSelection().removeAllRanges()}function Gett(){var qd={},qs={};for(var s=location.search.substr(1).split('&'),i=0;item=s[i];i++)qd[item.split('=')[0]]=decodeURIComponent(item.split('=')[1]);return{get:function(k){return(k in qd)?qd[k]:qd},set:function(k,v){qs[k]=v;return this},toString:function(){var k,res=[];for(k in qs)qd[k]=qs[k];for(k in qd)if(qd[k]!==null)res.push(k+'='+encodeURIComponent(qd[k]));return res.join('&')},ass:function(){location.search=this.toString()},rm:function(){qs={};return this},qd:qd}}function gate(x,y,z,id,controllerslist,mode,color="df7f00",comment="",xaxis=-1,zaxis=2,active=false,shapeId="9f0f56e8-2c31-4d83-996c-d00a9b296c3f"){gateobj={color:color,controller:{active:active,controllers:null,id:id,joints:null,mode:mode},pos:{x:-x,y:y,z:z},shapeId:shapeId,xaxis:xaxis,zaxis:zaxis};if(comment&&enablecomments){gateobj._comment_=comment};if(controllerslist){controllerslist=convertToSimpleArray(controllerslist);clist=[];for(var i=0;i<controllerslist.length;i++){clist[i]={id:controllerslist[i]}}}else{clist=null}gateobj["controller"]["controllers"]=clist;return gateobj}function convertToSimpleArray(array){var res=[];for(var i=0;i<array.length;i++)if(!Array.isArray(array[i]))res.push(array[i]);else res=res.concat(convertToSimpleArray(array[i]));return res}function arrCycle(istart,repeat,step=1){arr=[];for(var i=0;i<repeat;i++){arr[i]=istart+i*step}return arr}function binary(dig,id,step=1,io=0){razz=[];for(var i=0;i<size;i++){if((i%Math.pow(2,dig+1)>=Math.pow(2,dig+1)/2)^io){razz[razz.length]=id+step*i}}return razz}function exec(){var massiv={bodies:[{childs:[]}],version:2};var idd=iddlink=1000;var obj=[];function AddObj(ar){return obj[obj.length]=ar}pVAR=iddlink;iddlink+=8;pREQ=iddlink;iddlink+=8;pOUT=iddlink;iddlink+=8;pR=iddlink;iddlink+=1;pW=iddlink;iddlink+=1;siW=iddlink;iddlink+=2;orO=iddlink;iddlink+=8;ioRe=iddlink;iddlink+=16;regN=iddlink;iddlink+=size;mem=iddlink;iddlink+=4*8*size;idd=pVAR;for(var i=0;i<8;i++)AddObj(gate(i,1,3,idd++,arrCycle(mem+size*4*i+0,size,4),1,"d02525","@VAR "+i+"@",-3,-1));idd=pREQ;for(var i=0;i<8;i++)AddObj(gate(i,1,2,idd++,[ioRe+i*2,ioRe+i*2+1],1,"0a3ee2","@REQ "+i+"@",-3,-1));idd=pOUT;for(var i=0;i<8;i++)AddObj(gate(i,1,1,idd++,null,0,"19e753","@OUT "+i+"@",-3,-1));idd=pR;AddObj(gate(-1,1,1,idd++,arrCycle(pOUT,8),1,"2ce6e6","@ R   @",-3,-1));idd=pW;AddObj(gate(-1,1,3,idd++,[siW,siW+1],1,"720a74","@ W   @",-3,-1));idd=siW;AddObj(gate(-1,1,1,idd++,[idd],3,"0a3ee2","@siW !& @"));AddObj(gate(-1,1,0,idd++,arrCycle(mem+1,size*8,4),0,"0a3ee2","@siW & @"));idd=orO;for(var i=0;i<8;i++)AddObj(gate(i,1,2,idd++,[pOUT+i],1,"df7f00","@orO "+i+"@"));idd=ioRe;for(var i=0;i<8;i++){var iolm=[];var iolp=[];for(var u=0;u<8;u++){iolm[u]=binary(i,mem+size*4*u+1,4,0);iolp[u]=binary(i,mem+size*4*u+1,4,1)}AddObj(gate(i,1,0,idd++,[iolm,binary(i,regN,1,0)],1,"222222","@io- "+i+"@"));AddObj(gate(i,1,1,idd++,[iolp,binary(i,regN,1,1)],4,"222222","@io+ "+i+"@"))}idd=regN;for(var i=0;i<size;i++)AddObj(gate(-1,i+2,0,idd++,arrCycle(mem+i*4+3,8,size*4),0,"e2db13","@regN "+i+"@"));idd=mem;for(var i=0;i<8;i++){for(var u=0;u<size;u++){AddObj(gate(i,u+2,1,idd++,[idd],2,"df7f00","@MmX p"+i+" r"+u+"@"));AddObj(gate(i,u+2,2,idd++,[idd],0,"df7f00","@Mm& p"+i+" r"+u+"@"));AddObj(gate(i,u+2,3,idd++,[idd,idd-3,idd-1],2,"35086c","@MmSX p"+i+" r"+u+"@"));AddObj(gate(i,u+2,0,idd++,[orO+i],0,"df7f00","@Mou& p"+i+" r"+u+"@"))}}massiv["bodies"][0]["childs"]=obj;return JSON.stringify(massiv,"",4)}
	</script>
</body>

</html>