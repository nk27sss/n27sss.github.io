<html>

<head>
	<title>eval</title>
	<style type="text/css">
	body { margin: 0px; height: 100%; overflow: hidden; } * { background: #000; color: #080; border-color: #888; font-family: "consolas" } .inpform { position: absolute; border-top: 1px solid #080; width: 100%; height: 160px; bottom: 0px; padding-top: 0px; } .console { position: absolute; border-top: 1px solid #080; width: 100%; top: 25px; bottom: 160px; padding: 0px; margin: 0px; overflow-x: hidden; overflow-y: scroll; } .textar { max-width: 100%; width: 100%; max-height: 60px; height: 60px; outline: 1px solid #080; }
	</style>
</head>

<body>
	<h3>&nbsp;Калькулятор <i style='color:#0ff;'>Eval</i><x style='color:#fff;'>();</x></h3>
	<div class="console" id="console"><pre><label id="ret"></label></pre></div>
	<div class="inpform">
		<div style="padding: 5px;">
			<textarea id="text" class="textar" oninput="if(document.getElementById('isec').checked)ee();" onkeypress="ent(event,this);"></textarea>
		</div>
		<div style="padding: 5px;">
			<input type="button" name="exec" id="exec" value="Выполнить" onclick="ee()">
			<input type="checkbox" name="isec" id="isec">Выполнять сразу &nbsp;
			<input type="checkbox" name="enx" id="enx" checked>Enter вывести и очистить &nbsp;
			<br>
			<input type="button" name="clear" id="clear" value="Очистить" onclick="document.getElementById('ret').innerHTML='';">
			<input type="checkbox" name="log" id="log" checked onclick="document.getElementById('incode').disabled=!document.getElementById('log').checked;">Формировать log &nbsp;
			<input type="checkbox" name="incode" id="incode" checked>Оставить команды &nbsp;
		</div>
	</div>
</body>
<script type="text/javascript">
function ent(event, formElem) { if (document.getElementById('enx').checked) { if ((event.keyCode == 0xA) || (event.keyCode == 0xD)) { event.keyCode = ""; ee(); formElem.value = ''; } } else { if ((event.ctrlKey) && ((event.keyCode == 0xA) || (event.keyCode == 0xD))) ee(); } } function ee() { val = document.getElementById('text').value; if (val.charAt(0) == "\n") val = val.slice(1); command = ""; try { command = eval(val); } catch (e) { command = "<b><u style='color:#800;'>ERROR</u>:</b>&nbsp;" + e; } if (document.getElementById('log').checked) { if (document.getElementById('incode').checked) { document.getElementById('ret').innerHTML += "<b style='color:#0aa;'>#</b>&nbsp; <x style='color:#088;'>" + val + "</x>\n<b style='color:#0f0;'>&gt;</b>&nbsp;" + command + "\n"; } else { document.getElementById('ret').innerHTML += "<b style='color:#0f0;'>&gt;</b>&nbsp;" + command + "\n"; } } else { document.getElementById('ret').innerHTML = "<b style='color:#0f0;'>&gt;</b>&nbsp;" + command + "\n"; } document.getElementById('console').scrollTop = document.getElementById('console').scrollHeight; }
</script>

</html>
